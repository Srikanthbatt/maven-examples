pipeline {
   agent any

   environment {
       DB_USER = credentials('java_id').username
       DB_PASSWORD = credentials('java_id').password
   }

   stages {
       stage('Checkout') {
           steps {
               checkout scm
           }
       }

       stage('Build Backend') {
           steps {
               sh 'mvn clean install' // Assuming Maven is used for Spring Boot
           }
       }

       stage('Build Frontend') {
           steps {
               sh 'npm install' // Install frontend dependencies
               sh 'npm run build' // Build Angular app
           }
       }

       stage('Database Setup') {
           steps {
               sh "mysql -u $DB_USER -p$DB_PASSWORD -e 'CREATE DATABASE your_database'"
           }
       }

       stage('Deploy Backend') {
           steps {
               // Deploy the Spring Boot application, e.g., using Docker or other means
           }
       }

       stage('Deploy Frontend') {
           steps {
               // Deploy the Angular frontend to a web server or CDN
           }
       }

       stage('Test') {
           steps {
               // Run tests for the application (backend and frontend)
           }
       }

       stage('Cleanup') {
           steps {
               // Perform any cleanup or post-deployment tasks
           }
       }
   }

   post {
       success {
           // Notify or perform actions on success
       }
       failure {
           // Notify or perform actions on failure
       }
   }
}
